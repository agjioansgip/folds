<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>src/Data/Hash/CRC.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Hash</span><span class='hs-varop'>.</span><span class='hs-conid'>CRC</span>
<a name="line-2"></a>  <span class='hs-layout'>(</span>
<a name="line-3"></a>  <span class='hs-comment'>-- * 8 bit CRCs</span>
<a name="line-4"></a>    <span class='hs-varid'>crc8</span>
<a name="line-5"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>crc8_ccitt</span>
<a name="line-6"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>crc8_mvb</span>
<a name="line-7"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>crc8_sae</span>
<a name="line-8"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>crc8_wcdma</span>
<a name="line-9"></a>  <span class='hs-comment'>-- * 16 bit CRCs</span>
<a name="line-10"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>crc16</span>
<a name="line-11"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>crc16_ccitt</span>
<a name="line-12"></a>  <span class='hs-comment'>-- * 32 bit CRCs</span>
<a name="line-13"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>crc32</span>
<a name="line-14"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>crc32_c</span>
<a name="line-15"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>crc32_k</span>
<a name="line-16"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>crc32_q</span>
<a name="line-17"></a>  <span class='hs-comment'>-- * 64 bit CRCs</span>
<a name="line-18"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>crc64_ecma</span>
<a name="line-19"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>crc64_iso</span>
<a name="line-20"></a>  <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-21"></a>
<a name="line-22"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Bits</span>
<a name="line-23"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Fold</span><span class='hs-varop'>.</span><span class='hs-conid'>L'</span>
<a name="line-24"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Vector</span><span class='hs-varop'>.</span><span class='hs-conid'>Unboxed</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Unboxed</span>
<a name="line-25"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Word</span>
<a name="line-26"></a>
<a name="line-27"></a><span class='hs-comment'>-- * 64 bit CRCs</span>
<a name="line-28"></a>
<a name="line-29"></a><a name="crc64_iso"></a><span class='hs-comment'>-- | Used in &lt;<a href="http://en.wikipedia.org/wiki/High-Level_Data_Link_Control">http://en.wikipedia.org/wiki/High-Level_Data_Link_Control</a> HDLC&gt;, &lt;<a href="http://en.wikipedia.org/wiki/Swiss-Prot#UniProtKB.2FSwiss-Prot">http://en.wikipedia.org/wiki/Swiss-Prot#UniProtKB.2FSwiss-Prot</a> Swiss-Prot&gt; and &lt;<a href="http://en.wikipedia.org/wiki/TrEMBL">http://en.wikipedia.org/wiki/TrEMBL</a> TrEMBL&gt;, but it is &lt;<a href="http://www0.cs.ucl.ac.uk/staff/d.jones/crcnote.pdf">http://www0.cs.ucl.ac.uk/staff/d.jones/crcnote.pdf</a> considered weak&gt;</span>
<a name="line-30"></a><span class='hs-definition'>crc64_iso</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L'</span> <span class='hs-conid'>Word8</span> <span class='hs-conid'>Word64</span>
<a name="line-31"></a><span class='hs-definition'>crc64_iso</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>crc</span> <span class='hs-varid'>crc64_iso_lut</span>
<a name="line-32"></a><span class='hs-comment'>{-# INLINE crc64_iso #-}</span>
<a name="line-33"></a>
<a name="line-34"></a><a name="crc64_ecma"></a><span class='hs-comment'>-- | Used in &lt;<a href="http://www.ecma-international.org/publications/standards/Ecma-182.htm">http://www.ecma-international.org/publications/standards/Ecma-182.htm</a> ECMA-182&gt; and &lt;<a href="http://en.wikipedia.org/wiki/XZ_Utils">http://en.wikipedia.org/wiki/XZ_Utils</a> XZ Utils&gt;.</span>
<a name="line-35"></a><span class='hs-definition'>crc64_ecma</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L'</span> <span class='hs-conid'>Word8</span> <span class='hs-conid'>Word64</span>
<a name="line-36"></a><span class='hs-definition'>crc64_ecma</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>crc</span> <span class='hs-varid'>crc64_ecma_lut</span>
<a name="line-37"></a><span class='hs-comment'>{-# INLINE crc64_ecma #-}</span>
<a name="line-38"></a>
<a name="line-39"></a><a name="crc64_iso_lut"></a><span class='hs-definition'>crc64_iso_lut</span><span class='hs-layout'>,</span> <span class='hs-varid'>crc64_ecma_lut</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Unboxed</span><span class='hs-varop'>.</span><span class='hs-conid'>Vector</span> <span class='hs-conid'>Word64</span>
<a name="line-40"></a><span class='hs-definition'>crc64_iso_lut</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lut</span> <span class='hs-num'>0xD800000000000000</span>
<a name="line-41"></a><a name="crc64_ecma_lut"></a><span class='hs-definition'>crc64_ecma_lut</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lut</span> <span class='hs-num'>0xc96c5795d7870f42</span>
<a name="line-42"></a><span class='hs-comment'>{-# NOINLINE crc64_iso_lut #-}</span>
<a name="line-43"></a><span class='hs-comment'>{-# NOINLINE crc64_ecma_lut #-}</span>
<a name="line-44"></a>
<a name="line-45"></a><span class='hs-comment'>-- * 32 bit CRCs</span>
<a name="line-46"></a>
<a name="line-47"></a><a name="crc32"></a><span class='hs-comment'>-- | Standard CRC-32 as used in HDLC, ANSI X3.66, ITU-T V.42, Ethernet, Serial ATA,</span>
<a name="line-48"></a><span class='hs-comment'>-- MPEG-2, PKZIP, Gzip, Bzip2, PNG, and many other protocols and file formats.</span>
<a name="line-49"></a><span class='hs-definition'>crc32</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L'</span> <span class='hs-conid'>Word8</span> <span class='hs-conid'>Word32</span>
<a name="line-50"></a><span class='hs-definition'>crc32</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>crc</span> <span class='hs-varid'>crc32_lut</span>
<a name="line-51"></a><span class='hs-comment'>{-# INLINE crc32 #-}</span>
<a name="line-52"></a>
<a name="line-53"></a><a name="crc32_c"></a><span class='hs-comment'>-- | CRC-32 (Castagnoli) as used in iSCSI, SCTP, G.hn payload, SSE4.2, Btrfs, ext4</span>
<a name="line-54"></a><span class='hs-definition'>crc32_c</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L'</span> <span class='hs-conid'>Word8</span> <span class='hs-conid'>Word32</span>
<a name="line-55"></a><span class='hs-definition'>crc32_c</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>crc</span> <span class='hs-varid'>crc32_c_lut</span>
<a name="line-56"></a><span class='hs-comment'>{-# INLINE crc32_c #-}</span>
<a name="line-57"></a>
<a name="line-58"></a><a name="crc32_k"></a><span class='hs-comment'>-- | CRC-32 (Koopman)</span>
<a name="line-59"></a><span class='hs-definition'>crc32_k</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L'</span> <span class='hs-conid'>Word8</span> <span class='hs-conid'>Word32</span>
<a name="line-60"></a><span class='hs-definition'>crc32_k</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>crc</span> <span class='hs-varid'>crc32_k_lut</span>
<a name="line-61"></a><span class='hs-comment'>{-# INLINE crc32_k #-}</span>
<a name="line-62"></a>
<a name="line-63"></a><a name="crc32_q"></a><span class='hs-comment'>-- | CRC-32 as used in aviation; AIXM</span>
<a name="line-64"></a><span class='hs-definition'>crc32_q</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L'</span> <span class='hs-conid'>Word8</span> <span class='hs-conid'>Word32</span>
<a name="line-65"></a><span class='hs-definition'>crc32_q</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>crc</span> <span class='hs-varid'>crc32_q_lut</span>
<a name="line-66"></a><span class='hs-comment'>{-# INLINE crc32_q #-}</span>
<a name="line-67"></a>
<a name="line-68"></a><a name="crc32_lut"></a><span class='hs-definition'>crc32_lut</span><span class='hs-layout'>,</span> <span class='hs-varid'>crc32_c_lut</span><span class='hs-layout'>,</span> <span class='hs-varid'>crc32_k_lut</span><span class='hs-layout'>,</span> <span class='hs-varid'>crc32_q_lut</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Unboxed</span><span class='hs-varop'>.</span><span class='hs-conid'>Vector</span> <span class='hs-conid'>Word32</span>
<a name="line-69"></a><span class='hs-definition'>crc32_lut</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lut</span> <span class='hs-num'>0xedb88320</span>
<a name="line-70"></a><a name="crc32_c_lut"></a><span class='hs-definition'>crc32_c_lut</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lut</span> <span class='hs-num'>0x82f63b78</span>
<a name="line-71"></a><a name="crc32_k_lut"></a><span class='hs-definition'>crc32_k_lut</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lut</span> <span class='hs-num'>0xeb31d82e</span>
<a name="line-72"></a><a name="crc32_q_lut"></a><span class='hs-definition'>crc32_q_lut</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lut</span> <span class='hs-num'>0xd5828281</span>
<a name="line-73"></a><span class='hs-comment'>{-# NOINLINE crc32_lut #-}</span>
<a name="line-74"></a><span class='hs-comment'>{-# NOINLINE crc32_c_lut #-}</span>
<a name="line-75"></a><span class='hs-comment'>{-# NOINLINE crc32_k_lut #-}</span>
<a name="line-76"></a><span class='hs-comment'>{-# NOINLINE crc32_q_lut #-}</span>
<a name="line-77"></a>
<a name="line-78"></a><span class='hs-comment'>-- * 16 bit CRCs</span>
<a name="line-79"></a>
<a name="line-80"></a><a name="crc16"></a><span class='hs-comment'>-- | Used by Bisync, Modbus, USB, ANSI X3.28, SIA DC-07, many others; also known as CRC-16 and CRC-16-ANSI</span>
<a name="line-81"></a><span class='hs-definition'>crc16</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L'</span> <span class='hs-conid'>Word8</span> <span class='hs-conid'>Word16</span>
<a name="line-82"></a><span class='hs-definition'>crc16</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>crc</span> <span class='hs-varid'>crc16_lut</span>
<a name="line-83"></a><span class='hs-comment'>{-# INLINE crc16 #-}</span>
<a name="line-84"></a>
<a name="line-85"></a><a name="crc16_ccitt"></a><span class='hs-comment'>-- | Used by X.25, V.41, HDLC FCS, XMODEM, Bluetooth, PACTOR, SD, many others; known as CRC-CCITT</span>
<a name="line-86"></a><span class='hs-definition'>crc16_ccitt</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L'</span> <span class='hs-conid'>Word8</span> <span class='hs-conid'>Word16</span>
<a name="line-87"></a><span class='hs-definition'>crc16_ccitt</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>crc</span> <span class='hs-varid'>crc16_ccitt_lut</span>
<a name="line-88"></a><span class='hs-comment'>{-# INLINE crc16_ccitt #-}</span>
<a name="line-89"></a>
<a name="line-90"></a><a name="crc16_lut"></a><span class='hs-definition'>crc16_lut</span><span class='hs-layout'>,</span> <span class='hs-varid'>crc16_ccitt_lut</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Unboxed</span><span class='hs-varop'>.</span><span class='hs-conid'>Vector</span> <span class='hs-conid'>Word16</span>
<a name="line-91"></a><span class='hs-definition'>crc16_lut</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lut</span> <span class='hs-num'>0xA001</span>
<a name="line-92"></a><a name="crc16_ccitt_lut"></a><span class='hs-definition'>crc16_ccitt_lut</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lut</span> <span class='hs-num'>0x8408</span>
<a name="line-93"></a><span class='hs-comment'>{-# NOINLINE crc16_lut #-}</span>
<a name="line-94"></a><span class='hs-comment'>{-# NOINLINE crc16_ccitt_lut #-}</span>
<a name="line-95"></a>
<a name="line-96"></a><span class='hs-comment'>-- * 8 bit CRCs</span>
<a name="line-97"></a>
<a name="line-98"></a><a name="crc8"></a><span class='hs-definition'>crc8</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L'</span> <span class='hs-conid'>Word8</span> <span class='hs-conid'>Word8</span>
<a name="line-99"></a><span class='hs-definition'>crc8</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>crc</span> <span class='hs-varid'>crc8_lut</span>
<a name="line-100"></a><span class='hs-comment'>{-# INLINE crc8 #-}</span>
<a name="line-101"></a>
<a name="line-102"></a><a name="crc8_ccitt"></a><span class='hs-comment'>-- | Used by &lt;<a href="http://www.itu.int/rec/T-REC-I.432.1-199902-I/en">http://www.itu.int/rec/T-REC-I.432.1-199902-I/en</a> I.432.1&gt;; &lt;<a href="http://en.wikipedia.org/wiki/Asynchronous_Transfer_Mode">http://en.wikipedia.org/wiki/Asynchronous_Transfer_Mode</a> ATM&gt; and &lt;<a href="http://en.wikipedia.org/wiki/ISDN">http://en.wikipedia.org/wiki/ISDN</a> ISDN&gt; &lt;<a href="http://en.wikipedia.org/wiki/CRC-based_framing">http://en.wikipedia.org/wiki/CRC-based_framing</a> HEC&gt; and cell delineation</span>
<a name="line-103"></a><span class='hs-definition'>crc8_ccitt</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L'</span> <span class='hs-conid'>Word8</span> <span class='hs-conid'>Word8</span>
<a name="line-104"></a><span class='hs-definition'>crc8_ccitt</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>crc</span> <span class='hs-varid'>crc8_ccitt_lut</span>
<a name="line-105"></a><span class='hs-comment'>{-# INLINE crc8_ccitt #-}</span>
<a name="line-106"></a>
<a name="line-107"></a><a name="crc8_mvb"></a><span class='hs-comment'>-- | Used by &lt;<a href="http://en.wikipedia.org/wiki/Train_Communication_Network">http://en.wikipedia.org/wiki/Train_Communication_Network</a> Train Communication Network&gt;, &lt;<a href="http://en.wikipedia.org/wiki/IEC_60870-5">http://en.wikipedia.org/wiki/IEC_60870-5</a> IEC 60870-5&gt;</span>
<a name="line-108"></a><span class='hs-definition'>crc8_mvb</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L'</span> <span class='hs-conid'>Word8</span> <span class='hs-conid'>Word8</span>
<a name="line-109"></a><span class='hs-definition'>crc8_mvb</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>crc</span> <span class='hs-varid'>crc8_mvb_lut</span>
<a name="line-110"></a><span class='hs-comment'>{-# INLINE crc8_mvb #-}</span>
<a name="line-111"></a>
<a name="line-112"></a><a name="crc8_sae"></a><span class='hs-comment'>-- | Used by &lt;<a href="http://en.wikipedia.org/wiki/AES3">http://en.wikipedia.org/wiki/AES3</a> AES3&gt;</span>
<a name="line-113"></a><span class='hs-definition'>crc8_sae</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L'</span> <span class='hs-conid'>Word8</span> <span class='hs-conid'>Word8</span>
<a name="line-114"></a><span class='hs-definition'>crc8_sae</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>crc</span> <span class='hs-varid'>crc8_sae_lut</span>
<a name="line-115"></a><span class='hs-comment'>{-# INLINE crc8_sae #-}</span>
<a name="line-116"></a>
<a name="line-117"></a><a name="crc8_wcdma"></a><span class='hs-comment'>-- | Used by &lt;<a href="http://books.google.co.uk/books?id=yN5lve5L4vwC&lpg=PA223&dq=&pg=PA223#v=onepage&q&f=false">http://books.google.co.uk/books?id=yN5lve5L4vwC&amp;lpg=PA223&amp;dq=&amp;pg=PA223#v=onepage&amp;q&amp;f=false</a> WCDMA&gt;</span>
<a name="line-118"></a><span class='hs-definition'>crc8_wcdma</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L'</span> <span class='hs-conid'>Word8</span> <span class='hs-conid'>Word8</span>
<a name="line-119"></a><span class='hs-definition'>crc8_wcdma</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>crc</span> <span class='hs-varid'>crc8_wcdma_lut</span>
<a name="line-120"></a><span class='hs-comment'>{-# INLINE crc8_wcdma #-}</span>
<a name="line-121"></a>
<a name="line-122"></a><a name="crc8_lut"></a><span class='hs-definition'>crc8_lut</span><span class='hs-layout'>,</span> <span class='hs-varid'>crc8_ccitt_lut</span><span class='hs-layout'>,</span> <span class='hs-varid'>crc8_mvb_lut</span><span class='hs-layout'>,</span> <span class='hs-varid'>crc8_sae_lut</span><span class='hs-layout'>,</span> <span class='hs-varid'>crc8_wcdma_lut</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Unboxed</span><span class='hs-varop'>.</span><span class='hs-conid'>Vector</span> <span class='hs-conid'>Word8</span>
<a name="line-123"></a><span class='hs-definition'>crc8_lut</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lut</span> <span class='hs-num'>0xab</span>
<a name="line-124"></a><a name="crc8_ccitt_lut"></a><span class='hs-definition'>crc8_ccitt_lut</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lut</span> <span class='hs-num'>0xe0</span>
<a name="line-125"></a><a name="crc8_mvb_lut"></a><span class='hs-definition'>crc8_mvb_lut</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lut</span> <span class='hs-num'>0x53</span>
<a name="line-126"></a><a name="crc8_sae_lut"></a><span class='hs-definition'>crc8_sae_lut</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lut</span> <span class='hs-num'>0xb8</span>
<a name="line-127"></a><a name="crc8_wcdma_lut"></a><span class='hs-definition'>crc8_wcdma_lut</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lut</span> <span class='hs-num'>0xd9</span>
<a name="line-128"></a><span class='hs-comment'>{-# NOINLINE crc8_lut #-}</span>
<a name="line-129"></a><span class='hs-comment'>{-# NOINLINE crc8_ccitt_lut #-}</span>
<a name="line-130"></a><span class='hs-comment'>{-# NOINLINE crc8_mvb_lut #-}</span>
<a name="line-131"></a><span class='hs-comment'>{-# NOINLINE crc8_sae_lut #-}</span>
<a name="line-132"></a><span class='hs-comment'>{-# NOINLINE crc8_wcdma_lut #-}</span>
<a name="line-133"></a>
<a name="line-134"></a><span class='hs-comment'>-- * Implementation</span>
<a name="line-135"></a>
<a name="line-136"></a><a name="crc"></a><span class='hs-definition'>crc</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bits</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Unbox</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Unboxed</span><span class='hs-varop'>.</span><span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>L'</span> <span class='hs-conid'>Word8</span> <span class='hs-varid'>a</span>
<a name="line-137"></a><span class='hs-definition'>crc</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>L'</span> <span class='hs-varid'>complement</span> <span class='hs-varid'>step</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-138"></a>  <span class='hs-varid'>step</span> <span class='hs-varid'>r</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unsafeShiftR</span> <span class='hs-varid'>r</span> <span class='hs-num'>8</span> <span class='hs-varop'>`xor`</span> <span class='hs-varid'>l</span> <span class='hs-conid'>Unboxed</span><span class='hs-varop'>.!</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-layout'>(</span><span class='hs-varid'>xor</span> <span class='hs-varid'>r</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varop'>.&amp;.</span> <span class='hs-num'>0xff</span><span class='hs-layout'>)</span>
<a name="line-139"></a><span class='hs-comment'>{-# INLINE crc #-}</span>
<a name="line-140"></a>
<a name="line-141"></a><a name="lut"></a><span class='hs-definition'>lut</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Num</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bits</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Unbox</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Unboxed</span><span class='hs-varop'>.</span><span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span>
<a name="line-142"></a><span class='hs-definition'>lut</span> <span class='hs-varid'>seed</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Unboxed</span><span class='hs-varop'>.</span><span class='hs-varid'>generate</span> <span class='hs-num'>256</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span><span class='hs-varop'>.</span><span class='hs-varid'>go</span><span class='hs-varop'>.</span><span class='hs-varid'>go</span><span class='hs-varop'>.</span><span class='hs-varid'>go</span><span class='hs-varop'>.</span><span class='hs-varid'>go</span><span class='hs-varop'>.</span><span class='hs-varid'>go</span><span class='hs-varop'>.</span><span class='hs-varid'>go</span><span class='hs-varop'>.</span><span class='hs-varid'>go</span><span class='hs-varop'>.</span><span class='hs-varid'>fromIntegral</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-143"></a>  <span class='hs-varid'>go</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unsafeShiftR</span> <span class='hs-varid'>c</span> <span class='hs-num'>1</span> <span class='hs-varop'>`xor`</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>c</span> <span class='hs-varop'>.&amp;.</span> <span class='hs-num'>1</span> <span class='hs-varop'>/=</span> <span class='hs-num'>0</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>seed</span> <span class='hs-keyword'>else</span> <span class='hs-num'>0</span>
</pre></body>
</html>
